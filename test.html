<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>


        // 构建哈夫曼树

        // 层序遍历哈夫曼树，构建对象形式的树结构


        // 主函数
        function recoverHuffmanTree(leaf, values) {
            class TreeNode {
                constructor(value = 0, left = null, right = null) {
                    this.value = value;
                    this.left = left;
                    this.right = right;
                }
            }
            function buildHuffmanTree(leaf, values) {
                // 创建叶子节点
                const nodes = leaf.map((code, i) => new TreeNode(values[i]));

                // 生成哈夫曼树
                while (nodes.length > 1) {
                    nodes.sort((a, b) => a.value - b.value);

                    const left = nodes.shift();
                    const right = nodes.shift();

                    const merged = new TreeNode(left.value + right.value, left, right);
                    nodes.push(merged);
                }

                return nodes[0] || null;
            }

            const huffmanTree = buildHuffmanTree(leaf, values);

            function getLevelOrderObject(tree) {
                if (!tree) return {};

                const result = [];
                const queue = [{ node: tree, index: 0 }];

                while (queue.length > 0) {
                    const { node, index } = queue.shift();
                    if (node) {
                        result[index] = node.value;
                        queue.push({ node: node.left, index: 2 * index + 1 });
                        queue.push({ node: node.right, index: 2 * index + 2 });
                    } else {
                        result[index] = '#';
                    }
                }

                // 修剪结果中不需要的尾部空节点
                let i = result.length - 1;
                while (i >= 0 && result[i] === '#') {
                    i--;
                }

                return result.slice(0, i + 1).reduce((acc, val, i) => {
                    if (val !== undefined) acc[i] = val;
                    return acc;
                }, {});
            }


            return getLevelOrderObject(huffmanTree);
        }

        // 示例使用
        const leaf = ["0", "10", "110", "111"];
        const values = [3, 1, 1, 2];
        console.log(recoverHuffmanTree(leaf, values));
    </script>
</body>

</html>